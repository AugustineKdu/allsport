name: allsport
app: php
volumes:
  - name: allsports-data
    size: 10
    mount: /app/persistent
options:
  ports: 9000
  docbase: /public
  nodejs: true
  env:
    - name: APP_NAME
      value: "AllSports"
    - name: APP_ENV
      value: production
    - name: APP_KEY
      value: base64:SsWtZfj/IW0uDbw5r0aGQSd0CB58kUay7aMg/KdvQ5o=
    - name: APP_DEBUG
      value: "false"
    - name: APP_URL
      value: https://port-9000-allsport-m10pz2kw69fd7f89.sel4.cloudtype.app
    - name: DB_CONNECTION
      value: sqlite
    - name: DB_DATABASE
      value: /app/persistent/database.sqlite
    - name: SESSION_DRIVER
      value: file
    - name: CACHE_STORE
      value: file
    - name: QUEUE_CONNECTION
      value: sync
    - name: LOG_CHANNEL
      value: errorlog
    - name: LOG_LEVEL
      value: debug
    - name: SESSION_LIFETIME
      value: "120"
    # HTTPS Security Settings
    - name: FORCE_HTTPS
      value: "true"
    - name: SESSION_SECURE_COOKIE
      value: "true"
    - name: SESSION_SAME_SITE
      value: "lax"
    - name: CSRF_COOKIE_SECURE
      value: "true"
    - name: CSRF_COOKIE_SAME_SITE
      value: "lax"
    - name: SANCTUM_STATEFUL_DOMAINS
      value: "port-9000-allsport-m10pz2kw69fd7f89.sel4.cloudtype.app"
    - name: SESSION_COOKIE
      value: "laravel_session"
    # Asset URLs for HTTPS
    - name: ASSET_URL
      value: "https://port-9000-allsport-m10pz2kw69fd7f89.sel4.cloudtype.app"
    - name: MIX_ASSET_URL
      value: "https://port-9000-allsport-m10pz2kw69fd7f89.sel4.cloudtype.app"
  buildenv: []
  prestart: |
    chmod +x scripts/auto-restore.sh
    ./scripts/auto-restore.sh
  start: bash start.sh
  strategy: rolling
context:
  git:
    url: https://github.com/AugustineKdu/allsport.git
    branch: main
  preset: laravel
